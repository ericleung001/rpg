<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äº¤æ˜“æ‰€v3</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        body { 
            background-color: #2c3e50; color: #fff; 
            font-family: 'Press Start 2P', monospace; 
            text-align: center; 
            padding: 10px; 
            display:flex; flex-direction:column; align-items:center; 
            height: 100dvh; margin:0; box-sizing:border-box;
            overscroll-behavior: none;
            user-select: none; -webkit-user-select: none;
        }

        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #2c3e50; 
            z-index: 99999; 
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.5s ease-out;
        }
        .spinner {
            width: 40px; height: 40px;
            border: 4px solid #fff; border-top: 4px solid #f1c40f;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .header { width: 100%; max-width: 600px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .gold-display { color: #f1c40f; font-size: 14px; font-weight: bold; }
        h1 { font-size: 18px; margin: 0; }

        /* 1. åˆ†é¡é¸æ“‡åˆ— */
        .category-bar {
            width: 100%; max-width: 600px;
            display: grid; grid-template-columns: repeat(6, 1fr); gap: 4px; 
            margin-bottom: 15px;
        }
        .cat-btn {
            background: #34495e; color: #bdc3c7; border: 2px solid #7f8c8d;
            padding: 8px 2px; font-family: inherit; font-size: 9px; 
            border-radius: 6px; cursor: pointer; outline: none; white-space: nowrap;
        }
        .cat-btn.active { background: #f1c40f; color: #2c3e50; border-color: #fff; font-weight: bold; }
        .cat-btn:disabled { opacity: 0.5; cursor: default; }

        /* 2. ç‰©å“é¸æ“‡å€ */
        #item-select-area { 
            display: none; width: 100%; max-width: 600px;
            background: #34495e; border: 2px solid #bdc3c7; border-radius: 8px;
            padding: 10px; box-sizing: border-box; margin-bottom: 15px;
            max-height: 200px; overflow-y: auto;
            grid-template-columns: repeat(2, 1fr); gap: 8px;
        }
        .item-btn { 
            background: #2c3e50; border: 1px solid #7f8c8d; color: #ecf0f1; 
            padding: 10px; font-size: 10px; cursor: pointer; text-align: left; 
            border-radius: 4px; 
        }
        .item-btn:hover { background: #95a5a6; color: #2c3e50; }

        /* 3. æ›å–®åˆ—è¡¨å€ */
        #listings-area { 
            display: none; flex: 1; width: 100%; max-width: 600px;
            background: #fff; color: #000; border: 4px solid #f1c40f; 
            border-radius: 8px; padding: 5px; overflow-y: auto; 
            min-height: 200px; flex-direction: column;
        }
        .listing-header { 
            display: flex; font-size: 10px; font-weight: bold; 
            background: #eee; padding: 8px 5px; border-bottom: 2px solid #000; 
        }
        .listing-row { 
            display: flex; align-items: center; padding: 10px 5px; 
            border-bottom: 1px solid #ccc; font-size: 10px; 
        }
        .listing-row:nth-child(even) { background: #f9f9f9; }
        
        .col-name { flex: 2; text-align: left; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
        .col-price { flex: 1; text-align: right; color: #c0392b; font-weight: bold; }
        .col-seller { flex: 1; text-align: center; color: #7f8c8d; font-size: 8px; }
        .col-action { flex: 1; text-align: right; }

        .btn-buy { background: #27ae60; color: white; border: none; padding: 6px 10px; cursor: pointer; font-size: 10px; border-radius: 4px; }
        .btn-cancel { background: #c0392b; color: white; border: none; padding: 6px 10px; cursor: pointer; font-size: 10px; border-radius: 4px; }

        .back-btn { 
            background: #7f8c8d; color: white; padding: 15px; 
            text-decoration: none; font-size: 14px; 
            border: 3px solid #fff; display: block; 
            width: 100%; max-width: 600px; box-sizing: border-box; border-radius: 8px;
            margin-top: 10px;
        }

        #status-msg { font-size: 12px; color: #aaa; margin: 10px 0; }

        /* å½ˆå‡ºè¦–çª—æ¨£å¼ */
        .modal-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.85); display: none; 
            flex-direction: column; justify-content: center; align-items: center; z-index: 100;
        }
        .modal-box { 
            background: #fff; color: #000; 
            padding: 20px; border: 6px solid #f1c40f; 
            width: 85%; max-width: 320px; border-radius: 12px; 
            max-height: 80vh; overflow-y: auto; 
        }
        input { 
            width: 100%; padding: 12px; margin: 10px 0; 
            font-family: inherit; font-size: 16px; 
            box-sizing: border-box; border: 2px solid #ccc;
        }
        .btn { padding: 10px; border-radius: 6px; border:none; color:white; font-family:inherit; cursor:pointer; font-size:12px; width:100%; }
        .sell-list-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px solid #eee; }
        .sell-list-item button { width: auto; margin: 0; padding: 8px 12px; font-size: 10px; background: #e67e22;}

        #game-toast { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); background: rgba(0, 0, 0, 0.95); border: 2px solid #f1c40f; color: #fff; padding: 15px 30px; border-radius: 30px; z-index: 9999; font-size: 14px; font-weight: bold; transition: top 0.5s ease-in-out; pointer-events: none; }
        
        .btn-sell-trigger {
            width: 100%; max-width: 600px; margin-bottom: 10px;
            background: #e67e22; color: white; border: 2px solid #d35400;
            border-radius: 6px; cursor: pointer; font-family: inherit;
            font-size: 12px; font-weight: bold; padding: 10px;
        }
    </style>
</head>
<body>
    <div id="loading-overlay">
        <div class="spinner"></div>
        <div style="font-size:12px; margin-top:10px;">é€£æ¥äº¤æ˜“æ‰€...</div>
    </div>

    <div id="game-toast"></div>

    <div class="header">
        <h1>âš–ï¸ è‡ªç”±å¸‚å ´</h1>
        <div class="gold-display">ğŸ’° <span id="my-gold">0</span> G</div>
    </div>

    <button class="btn-sell-trigger" onclick="openInventoryModal()">+ ä¸Šæ¶ç‰©å“</button>

    <div class="category-bar">
        <button class="cat-btn" onclick="selectCategory('weapon')">âš”ï¸æ­¦å™¨</button>
        <button class="cat-btn" onclick="selectCategory('armor')">ğŸ›¡ï¸é˜²å…·</button>
        <button class="cat-btn" onclick="selectCategory('acc')">ğŸ’é£¾å“</button>
        <button class="cat-btn" onclick="selectCategory('consumable')">ğŸ§ªæ¶ˆè€—</button>
        <button class="cat-btn" onclick="selectCategory('material')">ğŸªµææ–™</button>
        <button class="cat-btn" onclick="selectCategory('mine')">ğŸ“¦æˆ‘çš„</button>
    </div>

    <div id="status-msg">è«‹é¸æ“‡ä¸Šæ–¹åˆ†é¡</div>
    <div id="item-select-area"></div>

    <div id="listings-area">
        <div class="listing-header">
            <div class="col-name">ç‰©å“</div>
            <div class="col-price">åƒ¹æ ¼</div>
            <div class="col-seller">è³£å®¶</div>
            <div class="col-action">æ“ä½œ</div>
        </div>
        <div id="listings-list"></div>
    </div>

    <a href="hub.html" class="back-btn">â—€ è¿”å›å¤§å»³</a>

    <div id="inventory-modal" class="modal-overlay">
        <div class="modal-box">
            <h3 style="font-size:16px; margin-bottom:15px;">é¸æ“‡è¦è³£çš„ç‰©å“</h3>
            <div id="sell-inventory-list" style="text-align:left;"></div>
            <button class="btn" style="background:#7f8c8d; margin-top:15px;" onclick="closeInventoryModal()">å–æ¶ˆ</button>
        </div>
    </div>

    <div id="sell-price-modal" class="modal-overlay">
        <div class="modal-box">
            <h3 id="modal-item-name" style="font-size:16px; margin-bottom:10px;">ä¸Šæ¶ç‰©å“</h3>
            <input type="number" id="sell-price" placeholder="è¼¸å…¥åƒ¹æ ¼ (G)" max="99999">
            <button class="btn" style="background:#e67e22; margin-top:10px;" onclick="confirmSell()">ç¢ºèªä¸Šæ¶</button>
            <button class="btn" style="background:#555; margin-top:10px;" onclick="closePriceModal()">å–æ¶ˆ</button>
        </div>
    </div>

    <script src="socket.io.js"></script>
    <script>
        // Loading
        window.addEventListener('load', () => {
            setTimeout(() => {
                const overlay = document.getElementById('loading-overlay');
                overlay.style.opacity = '0';
                setTimeout(() => { overlay.style.display = 'none'; }, 500);
            }, 1000);
        });

        const _0x5a1b = "aHR0cHM6Ly9ycGdnYW1lc2VyLmNj"; 
        const BACKEND_URL = atob(_0x5a1b);
        const socket = io(BACKEND_URL, { transports: ['websocket', 'polling'], secure: true });

        let myToken = localStorage.getItem('rpg_token');
        if (!myToken) window.location.href = 'index.html';

        // ç‰©å“è³‡æ–™åº«
        const ITEM_DB = {
            'copper_ore': { name: 'éŠ…ç¤¦çŸ³' }, 'soft_fur': { name: 'æŸ”è»Ÿçš®æ¯›' }, 'beast_fang': { name: 'é‡ç¸å°–ç‰™' }, 'slime_gel': { name: 'é»æ¶²' },
            'iron_ore': { name: 'éµç¤¦çŸ³' }, 'leather': { name: 'çš®é©' }, 'tough_hide': { name: 'ç¡¬çš®é©' }, 'magic_dust': { name: 'é­”ç²‰' },
            'poison_sac': { name: 'æ¯’å›Š' }, 'bone_shard': { name: 'ç¢éª¨ç‰‡' }, 'silver_ore': { name: 'éŠ€ç¤¦çŸ³' }, 'fire_core': { name: 'ç«ç„°æ ¸å¿ƒ' },
            'lava_rock': { name: 'ç†”å²©çŸ³' }, 'dragon_scale': { name: 'é¾é±—' }, 'gold_ore': { name: 'é‡‘ç¤¦çŸ³' }, 'ice_crystal': { name: 'æ°¸æ†å†°æ™¶' },
            'yeti_fur': { name: 'é›ªæ€ªæ¯›çš®' }, 'spirit_dust': { name: 'éˆé­‚ç²‰æœ«' }, 'mithril': { name: 'ç§˜éŠ€' }, 'void_dust': { name: 'è™›ç©ºä¹‹å¡µ' },
            'demon_horn': { name: 'æƒ¡é­”ä¹‹è§’' }, 'dark_essence': { name: 'æš—ä¹‹ç²¾è¯' }, 'adamantite': { name: 'ç²¾é‡‘' }, 'god_blood': { name: 'ç¥ä¹‹è¡€' },
            'chaos_orb': { name: 'æ··æ²Œå¯¶ç ' }, 'angel_feather': { name: 'å¤©ä½¿ä¹‹ç¾½' },
            'potion_hp': { name: "å°ç´…è—¥æ°´" }, 'potion_mid': { name: "ä¸­ç´…è—¥æ°´" }, 'potion_high': { name: "å¤§ç´…è—¥æ°´" }, 'potion_max': { name: "ç‰¹ç´šç§˜è—¥" },
            'elixir': { name: "ç¥ä¹‹ç”˜éœ²" }, 'potion_mp': { name: "å°è—è—¥æ°´" }, 'potion_mp_mid': { name: "ä¸­è—è—¥æ°´" }, 'potion_mp_high': { name: "å¤§è—è—¥æ°´" },
            'grilled_carp': { name: "çƒ¤é¯‰é­š" }, 'salmon_sushi': { name: "é®­é­šå£½å¸" }, 'tuna_steak': { name: "ç…é®ªé­šæ’" }, 'eel_rice': { name: "é°»é­šé£¯" },
            'void_soup': { name: "è™›ç©ºæµ·é®®æ¹¯" }, 'sushi_plate': { name: "å£½å¸æ‹¼ç›¤" },
            'wood_sword': { name: "æœ¨åŠ" }, 'copper_dagger': { name: "éŠ…åŒ•é¦–" }, 'iron_sword': { name: "éµåŠ" }, 'spike_club': { name: "ç‹¼ç‰™æ£’" },
            'poison_dag': { name: "åŠ‡æ¯’åŒ•é¦–" }, 'silver_blade': { name: "éŠ€åˆƒ" }, 'flame_staff': { name: "ç«ç„°æ³•æ–" }, 'gold_axe': { name: "é»ƒé‡‘å·¨æ–§" },
            'frost_bow': { name: "å¯’å†°å¼“" }, 'mithril_saber': { name: "ç§˜éŠ€è»åˆ€" }, 'void_reaper': { name: "è™›ç©ºæ”¶å‰²è€…" }, 'god_slayer': { name: "å¼’ç¥åŠ" },
            'chaos_staff': { name: "æ··æ²Œæ³•æ–" }, 'oak_bow': { name: "æ©¡æœ¨å¼“" }, 'maple_staff': { name: "æ¥“æœ¨æ³•æ–" }, 'shark_tooth': { name: "é¯Šé­šç‰™åŒ•é¦–" },
            'emerald_staff': { name: "ç¿¡ç¿ æ³•æ–" }, 'obsidian_blade': { name: "é»‘æ›œçŸ³ä¹‹åŠ" }, 'dragon_spear': { name: "é¾éª¨é•·æ§" },
            'cloth_armor': { name: "å¸ƒè¡£" }, 'hunt_vest': { name: "çµäººèƒŒå¿ƒ" }, 'leather_armor': { name: "çš®ç”²" }, 'chain_mail': { name: "é–å­ç”²" },
            'magma_plate': { name: "ç†”å²©èƒ¸ç”²" }, 'ice_robe': { name: "å†°éœœæ³•è¢" }, 'yeti_cloak': { name: "é›ªæ€ªæ–—ç¯·" }, 'demon_armor': { name: "æƒ¡é­”æˆ°ç”²" },
            'angel_armor': { name: "ç†¾å¤©ä½¿é§ç”²" },
            'bone_ring': { name: "éª¨æˆ’" }, 'ring_str': { name: "åŠ›é‡æˆ’æŒ‡" }, 'snake_boots': { name: "è›‡çš®é•·é´" }, 'amulet_soul': { name: "éˆé­‚è­·ç¬¦" },
            'ring_lord': { name: "é ˜ä¸»æŒ‡ç’°" }, 'crown_chaos': { name: "æ··æ²Œä¹‹å† " }, 'fish_ring': { name: "é­šé±—æˆ’æŒ‡" }, 'pearl_necklace': { name: "çç é …éŠ" }
        };

        let myInventory = {};
        let currentSellId = null;
        let currentItemKey = ''; 
        let currentPage = 1;

        socket.on('connect', () => {
            socket.emit('joinGame', myToken);
        });

        socket.on('playerStatsUpdate', (p) => {
            document.getElementById('my-gold').innerText = p.gold;
            myInventory = p.inventory;
        });

        // 1. é»æ“Šåˆ†é¡
        function selectCategory(cat) {
            currentItemKey = ''; 
            currentPage = 1;
            
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            // éš±è—æ‰€æœ‰å€åŸŸ
            document.getElementById('item-select-area').style.display = 'none';
            document.getElementById('listings-area').style.display = 'none';

            if (cat === 'mine') {
                document.getElementById('status-msg').innerText = "æŸ¥è©¢æˆ‘çš„æ›å–®...";
                document.getElementById('listings-list').innerHTML = '<div style="padding:10px;">è¼‰å…¥ä¸­...</div>';
                document.getElementById('listings-area').style.display = 'flex';
                socket.emit('getMyListings');
            } else {
                document.getElementById('status-msg').innerText = "è®€å–ç‰©å“æ¸…å–®...";
                socket.emit('getMarketItems', cat);
            }
        }

        // 2. æ¥æ”¶ç‰©å“æ¸…å–®
        socket.on('marketItemsList', (items) => {
            const area = document.getElementById('item-select-area');
            area.innerHTML = '';
            
            if (items.length === 0) {
                document.getElementById('status-msg').innerText = "æ­¤åˆ†é¡æš«ç„¡å¯äº¤æ˜“ç‰©å“";
                return;
            }

            document.getElementById('status-msg').innerText = "è«‹é¸æ“‡ç‰©å“æŸ¥è©¢åƒ¹æ ¼";
            area.style.display = 'grid';

            items.forEach(item => {
                const btn = document.createElement('div');
                btn.className = 'item-btn';
                btn.innerText = item.name;
                btn.onclick = () => loadListings(item.id, item.name);
                area.appendChild(btn);
            });
        });

        // 3. é»æ“Šç‰©å“ -> è«‹æ±‚æ›å–® (é è¨­ç¬¬1é )
        function loadListings(itemKey, itemName) {
            currentItemKey = itemKey;
            currentPage = 1;
            document.getElementById('status-msg').innerText = `æ­£åœ¨æŸ¥è©¢: ${itemName}`;
            document.getElementById('listings-list').innerHTML = '<div style="padding:10px; color:#aaa;">è¼‰å…¥ä¸­...</div>';
            document.getElementById('listings-area').style.display = 'flex';
            
            socket.emit('getMarketListings', { key: itemKey, page: 1 });
        }

        // æ›é åŠŸèƒ½
        function changePage(delta) {
            const newPage = currentPage + delta;
            if (newPage < 1) return;
            
            currentPage = newPage;
            document.getElementById('listings-list').innerHTML = '<div style="padding:10px; color:#aaa;">è®€å–ä¸­...</div>';
            
            if (currentItemKey) {
                socket.emit('getMarketListings', { key: currentItemKey, page: currentPage });
            }
        }

        // 4. æ¥æ”¶æ›å–® -> é¡¯ç¤ºåˆ—è¡¨ (å«åˆ†é )
        socket.on('marketListingsUpdate', (data) => {
            let listings = [];
            let totalPages = 1;
            let page = 1;

            if (Array.isArray(data)) {
                listings = data; 
            } else {
                listings = data.listings;
                totalPages = data.totalPages;
                page = data.currentPage;
            }

            const listDiv = document.getElementById('listings-list');
            listDiv.innerHTML = ''; // ğŸŸ¢ é—œéµä¿®æ­£ï¼šé€™è£¡æœƒæŠŠä¹‹å‰çš„æŒ‰éˆ•ä¹Ÿæ¸…æ‰

            if (listings.length === 0) {
                listDiv.innerHTML = '<div style="padding:20px; color:#555;">æ­¤é ç„¡ç‰©å“</div>';
            } else {
                listings.forEach(row => {
                    const div = document.createElement('div');
                    div.className = 'listing-row';
                    
                    let actionBtn = '';
                    if (row.isMine) {
                        actionBtn = `<button class="btn-cancel" onclick="cancelItem(${row.id})">å–å›</button>`;
                    } else {
                        actionBtn = `<button class="btn-buy" onclick="buyItem(${row.id}, ${row.price})">è³¼è²·</button>`;
                    }

                    div.innerHTML = `
                        <div class="col-name">${row.itemName}</div>
                        <div class="col-price">$${row.price}</div>
                        <div class="col-seller">${row.seller}</div>
                        <div class="col-action">${actionBtn}</div>
                    `;
                    listDiv.appendChild(div);
                });
            }

            // ğŸŸ¢ ä¿®æ­£ï¼šå°‡åˆ†é æ§åˆ¶åˆ—åŠ å…¥åˆ° listDiv (æ¯æ¬¡æ›´æ–°éƒ½æœƒé‡å»º)
            if (currentItemKey && totalPages > 0) { 
                const paginationDiv = document.createElement('div');
                paginationDiv.style.cssText = "display:flex; justify-content:center; gap:10px; padding:10px; align-items:center; border-top:2px solid #ccc; margin-top:auto;";
                
                const prevDisabled = page <= 1 ? 'disabled style="opacity:0.5; cursor:default;"' : '';
                const nextDisabled = page >= totalPages ? 'disabled style="opacity:0.5; cursor:default;"' : '';

                paginationDiv.innerHTML = `
                    <button class="cat-btn" ${prevDisabled} onclick="changePage(-1)">â—€ ä¸Šä¸€é </button>
                    <span style="font-size:10px; color:#333;">ç¬¬ ${page} / ${totalPages} é </span>
                    <button class="cat-btn" ${nextDisabled} onclick="changePage(1)">ä¸‹ä¸€é  â–¶</button>
                `;
                
                listDiv.appendChild(paginationDiv);
            }
        });

        // äº¤æ˜“åŠŸèƒ½
        function buyItem(id, price) {
            if(confirm(`ç¢ºå®šè¦èŠ±è²» ${price} G è³¼è²·å—ï¼Ÿ`)) {
                socket.emit('marketBuy', id);
            }
        }

        function cancelItem(id) {
            if(confirm("ç¢ºå®šä¸‹æ¶ä¸¦å–å›ç‰©å“å—ï¼Ÿ")) {
                socket.emit('marketCancel', id);
            }
        }

        // ä¸Šæ¶æµç¨‹
        function openInventoryModal() {
            const list = document.getElementById('sell-inventory-list');
            list.innerHTML = '';
            
            const keys = Object.keys(myInventory).filter(k => myInventory[k] > 0);
            
            if (keys.length === 0) {
                list.innerHTML = '<div style="padding:20px; color:#aaa; text-align:center;">èƒŒåŒ…æ˜¯ç©ºçš„ï¼Œç„¡ç‰©å¯è³£</div>';
            } else {
                keys.forEach(key => {
                    const itemData = ITEM_DB[key] || { name: key };
                    if (!itemData.name) return;

                    const div = document.createElement('div');
                    div.className = 'sell-list-item';
                    div.innerHTML = `
                        <div style="font-size:12px;">${itemData.name} (x${myInventory[key]})</div>
                        <button onclick="openPriceModal('${key}', '${itemData.name}')">è³£å‡º</button>
                    `;
                    list.appendChild(div);
                });
            }
            document.getElementById('inventory-modal').style.display = 'flex';
        }
        function closeInventoryModal() { document.getElementById('inventory-modal').style.display = 'none'; }

        function openPriceModal(key, name) {
            currentSellId = key;
            document.getElementById('modal-item-name').innerText = `è³£å‡º: ${name}`;
            document.getElementById('sell-price').value = '';
            document.getElementById('sell-price-modal').style.display = 'flex';
            document.getElementById('inventory-modal').style.display = 'none'; 
        }
        function closePriceModal() { document.getElementById('sell-price-modal').style.display = 'none'; }
        
        function confirmSell() {
            const priceInput = document.getElementById('sell-price');
            const price = parseInt(priceInput.value);

            if(!price || price <= 0) { showMsg("è«‹è¼¸å…¥æœ‰æ•ˆåƒ¹æ ¼"); return; }
            if (price > 99999) { showMsg("åƒ¹æ ¼ä¸èƒ½è¶…é 99,999 G"); return; }

            socket.emit('marketSell', { itemId: currentSellId, price: price });
        }

        function showMsg(text) {
            const t = document.getElementById('game-toast');
            t.innerText = text;
            t.style.top = "30px";
            setTimeout(() => { t.style.top = "-100px"; }, 3000);
        }

        socket.on('marketResult', (res) => { 
            showMsg(res.success ? "âœ… " + res.msg : "âŒ " + res.msg);
            closePriceModal();
            closeInventoryModal();
            if (res.success && currentItemKey) {
                socket.emit('getMarketListings', { key: currentItemKey, page: currentPage });
            }
            if (res.success && !currentItemKey) {
                socket.emit('getMyListings');
            }
        });
        
        socket.on('marketRefresh', () => {
            if (currentItemKey) {
                socket.emit('getMarketListings', { key: currentItemKey, page: currentPage });
            }
        });

    </script>
</body>
</html>
